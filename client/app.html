<template name="places">
{{> header}}
{{> leafletMap}}
{{> searchPanel}}
{{#if isPanelActive "help"}}
{{> panelHelp}}
{{/if}}
{{#if isPanelActive "place"}}
{{> panelPlace}}
{{/if}}
{{#if isPanelActive "edit"}}
{{> placeEditPanel}}
{{/if}}
</template>

<template name="searchPanel">
<div class="searchPanel">
  <form class="navbar-search pull-right">
    <input type="text" class="search-query" placeholder="Search">
  </form>
</div>
</template>

<template name="leafletMap">
{{#constant}}
<div id="leaflet-map" class="leflet-map"></div>
{{/constant}}
</template>

<template name="panelPlaceEdit">
<div class="panelPlaceEdit floatingPanel">
  abcd
</div>
</template>

<template name="panelHelp">
<div class="panelHelp floatingPanel">
  <label>
    <em>
      {{#if anyPlaces}}
      <i class="icon-th-list"></i> Select a place to see details
      {{else}}
      <i class="icon-minus-sign"></i> No places yet, but stay tuned!
      {{/if}}
    </em>
  </label>
  <label>
    <em>
      {{#if currentUser}}
      <i class="icon-home"></i> Ctrl + click the map to post a new place
      {{else}}
      <i class="icon-user"></i>
      Sign in to post a new place
      {{/if}}
    </em>
  </label>
</div>
</template>

<template name="panelPlace">
<div class="panelPlace floatingPanel">
  {{#with selectedPlace}}
  {{> details}}
  {{> placeResourcesPanel}}
  {{#unless public}}
  {{> sharedPanel}}
  {{/unless}}
  {{#if isOwner}}
  <div class="row">
    <div class="alert alert-info span2">
      <small>
        Need to <a href="#" class="removePlace">delete this place</a>?
      </small>
    </div>
  </div>
  {{/if}}
  {{/with}}
</div>
</template>

<template name="details">
<label>
  <i class="icon-bookmark"></i>
  <b>{{title}}</b>
  <em>- {{#if public}}Public{{else}}Private{{/if}}</em>
  {{#if isOwner}}
  <input type="button" class="btn btn-mini editPlace" value="Edit">
  {{/if}}
  <button type="button" aria-hidden="true" class="close">&times;</button>
</label>
<div class="indent">
  <small>{{creatorName}}</small> 
</div>
<div>
  <i class="icon-comment"></i>
  <em><b>About</b></em></div>
</div>
<div class="indent">{{description}}</div>
<div>
  <i class="icon-map-marker"></i>
  <em><b>Location</b></em>
  {{#if isOwner}}
  <input type="button" class="btn btn-mini editLocation" value="Edit">
  {{/if}}
</div>
<div class="indent">{{placeLocationGet}}</div>
</template>

<template name="placeResourcesPanel">
<label>
  {{#if placeHasResources}}
  <i class="icon-th-list"></i>
  {{else}}
  <i class="icon-minus-sign"></i>
  {{/if}}
  <em><b>Resources</b></em>
  {{#if isOwner}}
  <input type="button" class="btn btn-mini placeResourceAdd" value="Add">
  {{/if}}
</label>
{{#if placeHasResources}}
{{#each placeResources}}
<label for="" class="indent">
  {{#if isOwner}}
  <button type="button" aria-hidden="true" 
    class="close placeResourceRemove pull-left">
    &times;
  </button>
  {{else}}
  <i class="icon-ok"></i>
  {{/if}}
  {{this.title}}
</label>
{{/each}}
{{/if}}
</template>

<template name="sharedPanel">
<div class="sharedPanel well well-small">
<div class="muted usersList"><b>Friends:</b></div>
{{#each outstandingInvitations}}
<div>{{invitationName}}</div>
{{/each}}
{{#if nobody}}
<div>Nobody.</div>
{{/if}}
{{#if canInvite}}
<div class="invite">
  <a href="#" class="btn btn-mini invite">Invite More</a>
</div>
{{/if}}
</div>
</template>
